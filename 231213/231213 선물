            ### 12ì›” 13ì¼ SQL ë¬¸ì œ ğŸ…

-- 1. ì‚¬ì›ì´ë¦„, ì‚¬ì›ì§ì±…, ì‚¬ì›ê¸‰ì—¬ ì¡°íšŒ.
select ename, job, sal from emp
-- 
-- 2. ì‚¬ìˆ˜ë²ˆí˜¸ê°€ 7839ì¸ ì‚¬ì› ë²ˆí˜¸, ì´ë¦„, ì…ì‚¬ë‚ ì§œ ì¡°íšŒ.
select distinct
	sasu.empno as 'ì‚¬ìˆ˜ ì‚¬ì›ë²ˆí˜¸',
	sasu.ename as 'ì‚¬ìˆ˜ ì´ë¦„',
	sasu.hiredate as 'ì…ì‚¬ë‚ ì§œ'
from emp as busasu
inner join emp as sasu
on busasu.mgr = sasu.empno
where sasu.empno = 7839

-- 
-- 3. ê¸‰ì—¬ê°€ 3000 ì´í•˜ì¸ ì‚¬ì›ì˜ ëª¨ë“  ì •ë³´ ì¡°íšŒ.
select *from emp 
where sal <= 3000
-- 
-- 4. ì‚¬ì›ì´ë¦„, ë¶€ì„œë²ˆí˜¸, ë¶€ì„œì´ë¦„, ë¶€ì„œ ê·¼ë¬´ì§€ ì¡°íšŒ.
select 
	e.ename,
	e.deptno,
	d.dname,
	d.loc
from emp as e 
inner join dept as d
on e.deptno = d.deptno
-- 
-- 5. ë¶€ì„œë³„ ê¸‰ì—¬í•©ê³„, ë¶€ì„œì´ë¦„ ì¡°íšŒ.
select sum(e.sal), d.dname 
from emp as e 
inner join dept as d
on e.deptno = d.deptno
group by d.dname

-- 
-- 6. ë¶€ì„œ ê·¼ë¬´ì§€ê°€ NEW YORKì´ê³ , ì§ì±…ì´ MANAGERì¸ ì‚¬ì›ì˜ ì´ë¦„, ê¸‰ì—¬ ì¡°íšŒ. ?
select 
	e.ename,
	e.sal
from emp as e 
inner join dept as d
on e.deptno = d.deptno
where d.loc = 'NEWYORK' and e.job = 'MANAGER'
-- 
-- 7. 1983ë…„ ì´í›„ ì…ì‚¬í•œ ì‚¬ì›ì˜ ë³´ë„ˆìŠ¤ê°€ nullì´ë©´ 100 ì£¼ê³ , ì‚¬ì›ì˜ ì´ë¦„, ë¶€ì„œì´ë¦„, ì§ì—… ì¡°íšŒ.
select if(e.comm is null, '100','0') as 'ë³´ë„ˆìŠ¤', e.ename, d.dname, e.job
from emp as e
inner join dept as d
on e.deptno = d.DEPTNO 
where date_format(e.hiredate, '%Y') > 1983
-- 
-- 8. ë¶€ì„œëª…ì´ RESEARCHì¸ ì‚¬ì›ì˜ ì´ë¦„, ê¸‰ì—¬, ê·¼ë¬´ ì§€ì—­ ì¡°íšŒ. 
select 
	e.ename,
	e.sal,
	d.loc,
from emp as e
inner join dept as d
on e.deptno = d.deptno
where d.dname = 'RESEARCH'
-- 
-- 9. ë³´ë„ˆìŠ¤ë¥¼ ë°›ì€ ì‚¬ì› ì´ë¦„, ì§ì±…, ê¸‰ì—¬, ë¶€ì„œëª… ì¡°íšŒ.
select
	e.ename,
	e.job,
	e.sal,
	d.dname
from emp as e
inner join dept as d
on e.deptno = d.DEPTNO 
where e.comm is not null
--    ,
-- 10. ì´ë¦„ ì²«ê¸€ Aìë¥¼ ê°€ì§„ ì‚¬ì› ì´ë¦„, ì§ì±…, ë¶€ì„œëª…, ë¶€ì„œ ìœ„ì¹˜ ì¡°íšŒ.
select 
	e.ename,
	e.job,
	d.dname,
	d.loc
from emp as e
inner join dept as d
on e.deptno = d.DEPTNO 
where e.ename like 'A%'
-- 
-- 11. ì‚¬ì›ëª…, ì‚¬ìˆ˜ë²ˆí˜¸, ì‚¬ìˆ˜ ì´ë¦„ ì¡°íšŒ. ë‹¨, ì‚¬ìˆ˜ê°€ ì—†ëŠ” ì‚¬ì›ë„ í¬í•¨
select 
	busasu.ename as 'ì‚¬ì› ëª…',
	sasu.empno as 'ì‚¬ìˆ˜ ì‚¬ì›ë²ˆí˜¸',
	sasu.ename as 'ì‚¬ìˆ˜ ì´ë¦„'
from emp as busasu
inner join emp as sasu
on busasu.mgr = sasu.empno


-- 
-- 12. ì‚¬ì›ëª…, ì‚¬ìˆ˜ë²ˆí˜¸, ì‚¬ìˆ˜ ì´ë¦„ ì¡°íšŒ. ë‹¨, ì‚¬ìˆ˜ê°€ ì—†ëŠ” ì‚¬ì›ë§Œ
select 
	busasu.ename as 'ì‚¬ì› ëª…',
	sasu.empno as 'ì‚¬ìˆ˜ ì‚¬ì›ë²ˆí˜¸',
	sasu.ename as 'ì‚¬ìˆ˜ ì´ë¦„'
from emp as busasu
inner join emp as sasu
on busasu.mgr = sasu.empno
-- 
-- 13. ìƒì‚¬ë²ˆí˜¸ê°€ 7698ì¸ ì‚¬ì›ì˜ ì´ë¦„, ì‚¬ì›ë²ˆí˜¸, ìƒì‚¬ë²ˆí˜¸, ìƒì‚¬ì´ë¦„ ì¡°íšŒ.
select 
	busasu.ename,
	busasu.empno,
	sasu.empno,
	sasu.ename
from emp as busasu
inner join emp as sasu
on busasu.mgr = sasu.empno
where busasu.mgr = 7698
-- 
-- 14. ìƒì‚¬ë³´ë‹¤ ë¨¼ì € ì…ì‚¬í•œ ì‚¬ì›ì˜ ì‚¬ì›ì´ë¦„, ì‚¬ì›ì˜ ì…ì‚¬ì¼, ìƒì‚¬ ì´ë¦„, ìƒì‚¬ ì…ì‚¬ì¼ ì¡°íšŒ.
select 
	busasu.ename as 'ì‚¬ì› ì´ë¦„',
	busasu.hiredate as 'ì‚¬ì› ì…ì‚¬ì¼',
	sasu.ename as 'ìƒì‚¬ ì´ë¦„',
	sasu.hiredate as 'ìƒì‚¬ ì…ì‚¬ì¼'
from emp as busasu
inner join emp as sasu
on busasu.mgr = sasu.empno
where sasu.hiredate > busasu.hiredate
-- 
-- 15. ì—…ë¬´ê°€ MANAGERì´ê±°ë‚˜ CLERKê³  ì…ì‚¬ë‚ ì§œê°€ 1982ë…„ì— ì…ì‚¬í•œ
--     ì‚¬ì›ì˜ ì‚¬ì›ë²ˆí˜¸, ì´ë¦„, ê¸‰ì—¬, ì§ì—…, ë¶€ì„œëª… ì¡°íšŒ.
select 
	e.empno as 'ì‚¬ì›ë²ˆí˜¸',
	e.ename as 'ì´ë¦„', 
	e.sal as 'ê¸‰ì—¬', 
	e.job as 'ì§ì—…',
	d.dname as 'ë¶€ì„œëª…'
from emp as e
inner join dept as d
on e.deptno = d.DEPTNO
where e.job = 'MANAGER' or E.JOB = 'CLERK' and date_format(hiredate,'%Y') = '1982'

-- 
-- 16. ë¶€ì„œë³„ ê¸‰ì—¬ ì´í•© ì¡°íšŒ.
--     ë‹¨, ì‚¬ì›ì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë¶€ì„œë„ í¬í•¨í•´ì„œ ê¸‰ì—¬ ìˆœìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ í•˜ì‹œì˜¤.
select d.dname,
		sum(e.sal)
from emp as e right join dept as d
on e.deptno = d.DEPTNO 
where e.ename is null or e.ename is not null
group by d.dname


-- 
-- 17. ì‚¬ì› ì´ë¦„, ìƒì‚¬ ì´ë¦„, ì‚¬ì› ë¶€ì„œë²ˆí˜¸, ì‚¬ì› ë¶€ì„œëª…, ì‚¬ì› ê·¼ë¬´ì§€ì—­ ì¡°íšŒ.
--     ë‹¨, ì‚¬ì›ì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë¶€ì„œë²ˆí˜¸ì™€ ë¶€ì„œëª…ë„ ì¡°íšŒ.
select
	busasu.ename as "ì‚¬ì› ì´ë¦„",
	busasu.deptno as "ì‚¬ì› ë¶€ì„œë²ˆí˜¸",
	sasu.ename as "ìƒì‚¬ ì´ë¦„",
	d.dname as "ì‚¬ì› ë¶€ì„œëª…",
	d.loc as "ì‚¬ì› ê·¼ë¬´ì§€ì—­"
from emp as busasu
inner join dept as d
on busasu.deptno = d.deptno
inner join emp as sasu 
on busasu.mgr = sasu.empno
where busasu.ename is null or busasu.ename is not null
-- 
-- 18. ë¶€ì„œ ìœ„ì¹˜ê°€ CHICAGOì´ê³  ì‚¬ìˆ˜ ê¸‰ì—¬ê°€ 5000 ë¯¸ë§Œì¸
--     ì‚¬ì› ë²ˆí˜¸,ì‚¬ì› ì´ë¦„,ì‚¬ìˆ˜ ë²ˆí˜¸, ì‚¬ìˆ˜ ì´ë¦„, ì‚¬ìˆ˜ ê¸‰ì—¬, ë¶€ì„œëª… ì¡°íšŒ.
--     ë‹¨, ì‚¬ì›ì˜ ì…ì‚¬ë‚ ì§œë¡œ ì˜¤ë¦„ì°¨ìˆœ.
select 
	busasu.empno as 'ì‚¬ì›ë²ˆí˜¸',
	busasu.ename as 'ì‚¬ì›ì´ë¦„',
	sasu.empno as 'ì‚¬ìˆ˜ë²ˆí˜¸',
	sasu.ename as 'ì‚¬ìˆ˜ì´ë¦„',
	sasu.sal as 'ì‚¬ìˆ˜ ê¸‰ì—¬',
	
from emp as busasu
inner join emp as sasu
on busasu.mgr = sasu.empno
where d.loc = CHICACO, sasu.sal < 5000
-- 
-- 19. ì…ì‚¬ë‚ ì§œë¥¼ ì›”ë³„ë¡œ ëª‡ëª…ì´ ì…ì‚¬í–ˆëŠ”ì§€ ì¹´ìš´íŠ¸í•´ì„œ ì¡°íšŒ.
select count(*) from emp

-- 
-- 20. ë¶€ì„œë²ˆí˜¸, ë¶€ì„œì´ë¦„, ë¶€ì„œ ê·¼ë¬´ì§€, ì‚¬ì› ìˆ˜ ì¡°íšŒ ë‹¨, ì‚¬ì›ì´ ì—†ëŠ” ë¶€ì„œë„ ì¡°íšŒí•  ìˆ˜ ìˆê²Œ

select 
	e.deptno as 'ë¶€ì„œë²ˆí˜¸',
	d.dname as 'ë¶€ì„œì´ë¦„',
	d.loc as 'ê·¼ë¬´ì§€',
	count(*) as 'ì‚¬ì› ìˆ˜'
	
from emp as e right join dept as d
on e.deptno = d.deptno
where e.ename is  null 

select 
	e.deptno as 'ë¶€ì„œë²ˆí˜¸',
	d.dname as 'ë¶€ì„œì´ë¦„',
	d.loc as 'ê·¼ë¬´ì§€',
	count(*) as 'ì‚¬ì› ìˆ˜'
from emp as e
inner join dept as d
on e.deptno = d.DEPTNO 
where e.ename is not null 
group by d.dname
order by d.deptno

-- 
-- 21. 9ì›”ì— ì…ì‚¬í•œ ì‚¬ì›ì˜ ì´ë¦„, ë²ˆí˜¸, ì…ì‚¬ë‚ ì§œ ì¡°íšŒ.
select ename, empno, date_format(hiredate, '%Y-%m-%d') as 'ì…ì‚¬ë‚ ì§œ' from emp 
where date_format(hiredate, '%m') = 9
-- 
-- 22. ì§ì—…ì´ SALESMAN ì´ê³  ì…ì‚¬ë‚ ì§œê°€ 1981-02-22 ì´í›„ì— ë“¤ì–´ì˜¨ ì‚¬ì›ë“¤ì˜ ê¸‰ì—¬ ì´í•©, ê¸‰ì—¬í‰ê·  ì¡°íšŒ.
select sum(sal) as 'ê¸‰ì—¬ì´í•©', avg(sal) as 'ê¸‰ì—¬í‰ê· ' from emp 
where job = 'SALESMAN' and date_format(hiredate, '%Y-%m-%d') > 1981-02-22
-- 
-- 23. ì‚¬ì›ë²ˆí˜¸ 8080, ì‚¬ì›ì´ë¦„ í™ê¸¸ë™, ì§ì—… MANAGER, ì…ì‚¬ë‚ ì§œë¥¼ ì˜¤ëŠ˜ë‚ ì§œë¡œ ì‚¬ì› ì¶”ê°€í•˜ì‹œì˜¤. x
-- 
-- 24. ì‚¬ì›ë²ˆí˜¸ 8080ì¸ ì‚¬ì› ì‚¬ìˆ˜ë²ˆí˜¸ë¥¼ 7839ë¡œ ê¸‰ì—¬ë¥¼ 500ìœ¼ë¡œ ìˆ˜ì •í•˜ì‹œì˜¤. x
-- 
-- 25. ì‚¬ì›ë²ˆí˜¸ 8080ì¸ ì‚¬ì›ì„ ì‚­ì œí•˜ì‹œì˜¤. x
-- 
-- 26. ì‚¬ì›ìˆ˜ê°€ 4ëª… ì´ìƒì¸ ë¶€ì„œì˜ ë²ˆí˜¸, ì‚¬ì› ìˆ˜, ë¶€ì„œ ì´ë¦„, ë¶€ì„œ ìœ„ì¹˜ ì¡°íšŒ.
select 
	e.deptno,
	count(*),
	d.loc
from emp as e
inner join dept as d
on e.deptno = d.deptno
-- where count(*) >=4
